#include<time.h>
#include<stdio.h>
#include<curses.h>
#include<stdlib.h>
# define l 10 // l =ligne
# define c 30 // c =colonne
int sortie[4][10];
int k=0;  float u=0.9;
float des[l][l]={{1,0,0,0,0,0,0,0,0,0},
               {0,1,0,0,0,0,0,0,0,0},
               {0,0,1,0,0,0,0,0,0,0},
               {0,0,0,1,0,0,0,0,0,0},
               {0,0,0,0,1,0,0,0,0,0},
               {0,0,0,0,0,1,0,0,0,0},
               {0,0,0,0,0,0,1,0,0,0},
               {0,0,0,0,0,0,0,1,0,0},
               {0,0,0,0,0,0,0,0,1,0},
               {0,0,0,0,0,0,0,0,0,1},
               };
float E[l][c]={{1,1,1,1,1, //0  Numbers to learn
             1,0,0,0,1,
             1,0,0,0,1,
             1,0,0,0,1,
             1,0,0,0,1,
             1,1,1,1,1},

             {0,0,1,0,0,//1
             0,0,1,0,0,
             0,0,1,0,0,
             0,0,1,0,0,
             0,0,1,0,0,
             0,0,1,0,0},

             {1,1,1,1,1,//2
             0,0,0,0,1,
             1,1,1,1,1,
             1,0,0,0,0,
             1,0,0,0,0,
             1,1,1,1,1},

             {1,1,1,1,1,//3
             0,0,0,0,1,
             1,1,1,1,1,
             0,0,0,0,1,
             0,0,0,0,1,
             1,1,1,1,1},

             {1,0,0,0,0,//4
             1,0,0,0,0,
             1,0,0,1,0,
             1,1,1,1,1,
             1,0,0,1,0,
             1,0,0,1,0},

             {1,1,1,1,1,//5
             1,0,0,0,0,
             1,1,1,1,1,
             0,0,0,0,1,
             0,0,0,0,1,
             1,1,1,1,1},

             {1,1,1,1,1,//6
             1,0,0,0,0,
             1,0,0,0,0,
             1,1,1,1,1,
             1,0,0,0,1,
             1,1,1,1,1},

             {1,1,1,1,1,//7
             0,0,0,1,0,
             0,0,0,1,0,
             0,0,1,1,1,
             0,0,0,1,0,
             0,0,0,1,0},

             {1,1,1,1,1,//8
             1,0,0,0,1,
             1,1,1,1,1,
             1,0,0,0,1,
             1,0,0,0,1,
             1,1,1,1,1},

             {1,1,1,1,1,//9
             1,0,0,0,1,
             1,1,1,1,1,
             0,0,0,0,1,
             0,0,0,0,1,
             1,1,1,1,1},

            };
  float F[l][c]={{1,1,1,1,1, //0 Input with errors to test
             1,0,0,0,1,
             1,0,0,0,1,
             1,0,0,0,1,
             1,1,1,1,1},

             {0,0,1,0,0,//1
             0,0,1,0,0,
             0,0,0,0,1,
             0,0,1,0,0,
             0,0,1,0,0,
             0,0,1,0,0},

             {1,1,1,1,1,//2
             0,0,0,0,1,
             1,1,1,1,1,
             1,0,1,0,0,
             0,0,0,0,1,
             1,1,1,0,1}};







float w[l][c];
float som,o;int t=1,g=0;int i,j;

int main(){
 srand(time(NULL));
  for(i=0;i<l;i++)
    for(j=0;j<c;j++)
  w[i][j]=(float)rand()/RAND_MAX;
 printf("l'apprentissage\n");
 while(t&&g<1000000)
 {
  t=0;
  {

      for(k=0;k<10;k++) {//k neurons numbers
          som=0.;
          for(i=0;i<30;i++)//Input
             som=som+E[j][i]*w[k][i];
          o = (som<0)?0:1;
        if(o != des[j][k])
        {
        for(i=0;i<30;i++)
          w[k][i]=w[k][i]+u*((des[j][k]-o)*E[j][i]);//update every neuron
        t=1;
        }
                       }


  }g++;

  printf("\n  nouv poids :\n");
  for(i=0;i<l;i++){
  printf("\n");
   for(j=0;j<c;j++) printf("w[%d][%d]=%.2f \t",i,j, w[i][j]);}
   printf("\n nbr de period pr Cv : %d\n",g);
    }
printf("comapraison \n");
   for(j=0;j<3;j++)
  {

      for(k=0;k<10;k++) {
          som=0.;
          for(i=0;i<30;i++)
         som=som+F[j][i]*w[k][i];//Optimize F the inputs ith error 
            sortie[j][k] = (som<0)?0:1;
          }
          }
    for(j=0;j<3;j++)
      { printf("\n");
        for(k=0;k<10;k++){
          printf("%d ",sortie[j][k]);
        }
      }
    getchar();
return 0;
  }
